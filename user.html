<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Widget Test</title>
</head>
<body>

<div id="themeWidget" style="position:fixed;bottom:30px;right:30px;width:300px;padding:20px;background:#eee;border:1px solid #ccc;">
    <h3>Widget Test</h3>
    <div id="locationName">Loading location...</div>
    <div id="currentThemeName">Loading theme...</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', async () => {
    console.log('DOM loaded'); // Check 1

    // Minimal API call test
    try {
        console.log('Calling API...');
        const res = await fetch('https://ghlengine-production.up.railway.app/api/locations/real-time', {
            headers: { 'Authorization': 'Bearer 110' }
        });
        const data = await res.json();
        console.log('API response:', data); // Check 2

        if(data.success && data.data && data.data.length){
            const location = data.data[0];
            console.log('Location loaded:', location); // Check 3
            document.getElementById('locationName').textContent = location.name || 'No name';
            document.getElementById('currentThemeName').textContent = location.currentTheme?.name || 'No theme applied';
        } else {
            console.warn('No location data found');
        }

    } catch(e){
        console.error('API fetch failed:', e); // Check 4
        document.getElementById('locationName').textContent = 'Error loading location';
        document.getElementById('currentThemeName').textContent = 'Error loading theme';
    }

    console.log('Widget init done'); // Check 5
});
</script>

</body>
</html>
